---
title: 'Pyth Price Feedsã‚’ä½¿ã£ãŸBerachainä¸Šã®ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã®ç…§ä¼š  [Berachainç¿»è¨³]'
tags:
  - Blockchain
  - Ethereum
  - Web3
  - DALayer
  - Berachain
private: false
updated_at: '2024-09-09T16:43:29+09:00'
id: 8ce0fbe8628b0c2756a1
organization_url_name: sunriselayer
slide: false
ignorePublish: false
---
:::note info
æœ¬è¨˜äº‹ã¯ä¸‹è¨˜ã®ç¿»è¨³ã¨ãªã‚Šã¾ã™ã€‚
[ã€Query Price Data on Berachain using Pyth Price Feedsã€](https://blog.berachain.com/blog/query-price-data-on-berachain-using-pyth-price-feeds)
:::

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1926720/84194477-58dc-c917-b1f2-b0024cd072a9.png)

## Pyth ã‚’ä½¿ç”¨ã—ã¦ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ä¾¡æ ¼ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã™ã‚‹ ğŸ”®

ã‚ªãƒ©ã‚¯ãƒ«ã¯ã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¨ç¾å®Ÿä¸–ç•Œã‚’ã¤ãªãå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚æ—¢å­˜ã®ã‚ªãƒ©ã‚¯ãƒ«ã®ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã¯ã€ã‚ªãƒ©ã‚¯ãƒ«ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãŒé€£ç¶šã—ã¦ä¾¡æ ¼ã®æ›´æ–°ã‚’ã‚ªãƒ³ãƒã‚§ãƒ¼ãƒ³ã«ãƒ—ãƒƒã‚·ãƒ¥ã—ï¼ˆé–¢é€£ã™ã‚‹æ‰‹æ•°æ–™ã‚’æ”¯æ‰•ã†ï¼‰ã€ä¾¡æ ¼ãƒ•ã‚£ãƒ¼ãƒ‰ã¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒã‚§ãƒ¼ãƒ³ã®æ•°ãŒå¢—ãˆã‚‹ã¨ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãŒæ‚ªåŒ–ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

[**_Pyth Network_**](https://pyth.network/?ref=berachain.ghost.io)ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¿…è¦ãªæ™‚ã«ã®ã¿ã‚ªãƒ³ãƒã‚§ãƒ¼ãƒ³ã®ä¾¡æ ¼ã‚’å–å¾—ã™ã‚‹ã“ã¨ã§ã€ã“ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’è§£æ¶ˆã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚è©³ç´°ã¯[ã“ã¡ã‚‰](https://pyth.network/blog/pyth-a-new-model-to-the-price-oracle?ref=berachain.ghost.io)ã‚’ã”è¦§ãã ã•ã„ã€‚

**ã“ã®è¨˜äº‹ã§ã¯ã€Pyth ã‚ªãƒ©ã‚¯ãƒ«ã‚’æ´»ç”¨ã—ã¦ ETH/USD ä¾¡æ ¼ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’æ¶ˆè²»ã™ã‚‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆæ‰‹é †ã‚’æ¡ˆå†…ã—ã¾ã™ã€‚**

![](https://super-translator.inaridiy.workers.dev/assets/image/06b2bc17-f496-4358-8e8e-85358bedce76)
_Overview of Interactions_

### ğŸ“‹ è¦ä»¶

æ¬¡ã«é€²ã‚€å‰ã«ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ä»¥ä¸‹ã®ã‚‚ã®ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã€ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

- NodeJS `v20.11.0` ä»¥ä¸Š
- [pnpm](https://pnpm.io/installation?ref=berachain.ghost.io)
- [jq](https://jqlang.github.io/jq/download/?ref=berachain.ghost.io)â€Šâ€”â€ŠJSON ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ã«ä½¿ç”¨ã—ã¾ã™
- [**Berachain Artio Network**](https://docs.berachain.com/developers/?ref=berachain.ghost.io)ã§æ§‹æˆã•ã‚ŒãŸã‚¦ã‚©ãƒ¬ãƒƒãƒˆ
- ãã®ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã«`$BERA`ã¾ãŸã¯ Berachain ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆãƒˆãƒ¼ã‚¯ãƒ³ãŒã‚ã‚‹ã“ã¨ â€Šâ€”â€Š[**_Berachain Faucet_**](http://artio.faucet.berachain.com/?ref=berachain.ghost.io)ã‚’å‚ç…§ã—ã¦ãã ã•ã„

### Foundry

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ Foundry ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ã€‚ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

```terminal
curl -L https://foundry.paradigm.xyz | bash;

foundryup;
# foundryup installs the 'forge' and 'cast' binaries, used later
```

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€Foundry ã®[ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¬ã‚¤ãƒ‰](https://book.getfoundry.sh/getting-started/installation?ref=berachain.ghost.io)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚Berachain ã§ Foundry ã‚’ä½¿ç”¨ã™ã‚‹è©³ç´°ã«ã¤ã„ã¦ã¯ã€ã“ã®[ã‚¬ã‚¤ãƒ‰](https://docs.berachain.com/developers/guides/create-erc20-contract-using-foundry?ref=berachain.ghost.io)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### Pyth Oracle ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

ã¾ãšã€Foundry ã‚’ä½¿ç”¨ã—ã¦é–‹ç™ºç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€Foundry ã‚’åˆæœŸåŒ–ã—ã¾ã™ï¼š

```terminal
forge init pyth-oracle --no-git --no-commit;

cd pyth-oracle;

# We observe the following basic layout
# .
# â”œâ”€â”€ foundry.toml
# â”œâ”€â”€ script
# â”‚   â””â”€â”€ Counter.s.sol
# â”œâ”€â”€ src
# â”‚   â””â”€â”€ Counter.sol
# â””â”€â”€ test
#     â””â”€â”€ Counter.t.sol
```

### Pyth ã®ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Pyth ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’åˆ©ç”¨ã™ã‚‹ãŸã‚ã«ã€ã¾ãš Pyth ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’ãƒãƒ¼ãƒ‰ã®ä¾å­˜é–¢ä¿‚ã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```terminal
# FROM: ./pyth-oracle

pnpm init;
pnpm add @pythnetwork/pyth-sdk-solidity;
```

Forge ã¯ä¾å­˜é–¢ä¿‚ã‚’å†ãƒãƒƒãƒ—ã—ã¦ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ã‚ˆã‚Šèª­ã¿ã‚„ã™ãã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€Pyth ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’ remap ã—ã¾ã—ã‚‡ã†:

```terminal
# FROM: ./pyth-oracle

echo "remappings = ['@pythnetwork/pyth-sdk-solidity/=node_modules/@pythnetwork/pyth-sdk-solidity']" >> ./foundry.toml
```

### Oracle Consumer ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä½œæˆ

ã•ã‚ã€Solidity ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§ Pyth ã®ä¾¡æ ¼ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’æ¶ˆè²»ã™ã‚‹ã‚¨ã‚­ã‚µã‚¤ãƒ†ã‚£ãƒ³ã‚°ãªéƒ¨åˆ†ã«å…¥ã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ« `./src/ConsumerContract.sol` ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "@pythnetwork/pyth-sdk-solidity/IPyth.sol";
import "@pythnetwork/pyth-sdk-solidity/PythStructs.sol";

contract ConsumerContract {
    IPyth pyth;

    /**
     * Network: Berachain Artio (testnet)
     * Address: 0x8D254a21b3C86D32F7179855531CE99164721933
     */
    constructor() {
        pyth = IPyth(0x8D254a21b3C86D32F7179855531CE99164721933);
    }

    function updatePrice(bytes[] calldata priceUpdateData) public payable {
        uint fee = pyth.getUpdateFee(priceUpdateData);
        pyth.updatePriceFeeds{value: fee}(priceUpdateData);
    }

    function getPrice() public view returns (PythStructs.Price memory) {
        // ETH/USD priceID
        bytes32 priceID = 0xff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace;
        return pyth.getPrice(priceID);
    }

    function getLatestPrice(
        bytes[] calldata priceUpdateData
    ) public payable returns (PythStructs.Price memory) {
        updatePrice(priceUpdateData);
        return getPrice();
    }
}
```

ã•ã¦ã€ã“ã‚Œã‚’è©³ã—ãè¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ã¾ãšã€`IPyth`ã¨`PythStructs`ã‚’**import**ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸ Pyth ã‚ªãƒ©ã‚¯ãƒ«ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã®ã‚„ã‚Šå–ã‚Šã®ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒæä¾›ã•ã‚Œã¾ã™ã€‚[Pyth SDK](https://github.com/pyth-network/pyth-crosschain/tree/main/target_chains/ethereum/sdk/solidity?ref=berachain.ghost.io)ã®ä½¿ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã®è©³ç´°ã¯ã€ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„ã€‚

**constructor**ã§ã¯ã€Berachain Artio ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆä¸Šã«å±•é–‹ã•ã‚ŒãŸ Pyth ã‚ªãƒ©ã‚¯ãƒ«ã«`pyth`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’æ¥ç¶šã—ã¦ã„ã¾ã™ã€‚ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯[`0x8D254a21b3C86D32F7179855531CE99164721933`](https://artio.beratrail.io/address/0x8D254a21b3C86D32F7179855531CE99164721933/contract/80085/code?ref=berachain.ghost.io)ã§ã™ã€‚

`**updatePrice**`é–¢æ•°ã¯ã€Pyth ã‚ªãƒ•ãƒã‚§ãƒ¼ãƒ³ã‹ã‚‰ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã•ã‚Œã‚‹ç½²åä»˜ãä¾¡æ ¼æ›´æ–°ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚‹`priceUpdateData`ã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚Šã¾ã™ï¼ˆå¾Œè¿°ï¼‰ã€‚

ä¾¡æ ¼ã®æ›´æ–°å¾Œã«ã¯ã€`**getPrice()**`ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¦æ±‚ã•ã‚ŒãŸ`priceId`ã«å¯¾å¿œã™ã‚‹`Price`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¿”ã•ã‚Œã¾ã™ã€‚ã“ã“ã§ã¯ã€`priceId`ã¨ã—ã¦`0xff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace`ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ä½¿ç”¨å¯èƒ½ãªãƒ•ã‚£ãƒ¼ãƒ‰ã®å®Œå…¨ãªãƒªã‚¹ãƒˆã«ã¤ã„ã¦ã¯ã€[**ã“ã¡ã‚‰**](https://pyth.network/developers/price-feed-ids?ref=berachain.ghost.io)ã‚’ã”è¦§ãã ã•ã„ã€‚

`getLatestPrice`ã¯ã€ä¸Šè¨˜ã® 2 ã¤ã®å‘¼ã³å‡ºã—ã‚’å˜ç´”ã«é›†ç´„ã—ã¦ã„ã¾ã™ã€‚
ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ç”Ÿæˆã•ã‚ŒãŸ`src/Counter.sol`ã€`test/Counter.t.sol`ã€`script/Counter.s.sol`ã‚’å‰Šé™¤ã—ã¦ã‚‚æ§‹ã„ã¾ã›ã‚“ï¼‰

## ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤

Berachain ã«ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æº–å‚™ãŒã»ã¼æ•´ã„ã¾ã—ãŸã€‚ã¾ãšã€ãƒ‡ãƒ—ãƒ­ã‚¤ã«ä½¿ç”¨ã™ã‚‹ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### ãƒ‡ãƒ—ãƒ­ã‚¤ã®æº–å‚™

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ã‚¦ã‚©ãƒ¬ãƒƒãƒˆã®ç§˜å¯†éµã‚’ Foundry ã®ã‚­ãƒ¼ã‚¹ãƒˆã‚¢ã«ï¼ˆ`deployer`ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã§ï¼‰ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™:

```
cast wallet import deployer --interactive;

# [Example Output]
# Enter private key:
# Enter password:
# `deployer` keystore was saved successfully. Address: <YOUR_WALLET_ADDRESS>
```

ã‚¦ã‚©ãƒ¬ãƒƒãƒˆãŒã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:

```terminal
cast wallet list;

# [Example Output]
# deployer (Local)
```

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚»ãƒƒã‚·ãƒ§ãƒ³ã« Berachain RPC ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã—ã‚‡ã†ï¼š

```terminal
export BERACHAIN_ARTIO_RPC="https://rpc.ankr.com/berachain_testnet"
```

### Berachain ãƒ†ã‚¹ãƒˆãƒãƒƒãƒˆã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤

ã¾ãšã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¾ã™ï¼š

```terminal
# FROM: ./pyth-oracle

forge build;
```

`./out`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã„ãã¤ã‹ã®ãƒ“ãƒ«ãƒ‰å‡ºåŠ›ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã«æ°—ä»˜ãã§ã—ã‚‡ã†ã€‚

æ–°ã—ã„ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ Berachain Testnet ã«å±•é–‹ã™ã‚‹ãŸã‚ã«ã€`forge create`ã‚³ãƒãƒ³ãƒ‰ã‚’åˆ©ç”¨ã—ã¾ã™ï¼ˆã‚³ãƒãƒ³ãƒ‰ã®è©³ç´°ã¯[ã“ã¡ã‚‰](https://book.getfoundry.sh/reference/forge/forge-create?ref=berachain.ghost.io)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼‰:

```terminal
# FROM: ./pyth-oracle

forge create ./src/ConsumerContract.sol:ConsumerContract --rpc-url $BERACHAIN_ARTIO_RPC --account deployer

# [Expected Similar Output]:
# Enter keystore password:
# Deployer: 0x529CA3A690E1bB4e9F04d132bd99D4398f626A44
# Deployed to: 0x9106b2041C896224Af2142ea9C7349aa283Df7C6
# Transaction hash: 0xc8efdd3132080491b42c469fb2219bc6f0432981a46cdd3f6ae73b9e834ff4e4
```

**Take note of the deployed contract address**, æ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§å¿…è¦ã«ãªã‚Šã¾ã™ã€‚

å…ˆã«è¨­å®šã—ãŸã‚­ãƒ¼ã‚¹ãƒˆã‚¢ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å…¥åŠ›ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆè²»ç”¨ã®æ”¯æ‰•ã„ã«$BERA ãŒå¿…è¦ã§ã™ã€‚Faucet è³‡é‡‘ã¯[https://artio.faucet.berachain.com/](https://artio.faucet.berachain.com/?ref=berachain.ghost.io)ã§å…¥æ‰‹ã§ãã¾ã™ã€‚

## ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã¨ã®ã‚„ã‚Šå–ã‚Š

æœ€å¾Œã«ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‹ã‚‰`ETH/USD`ã®ä¾¡æ ¼ã‚’å–å¾—ã—ã¾ã™ã€‚

`updatePrice`ã‚’å‘¼ã³å‡ºã™å‰ã«ã€`priceUpdateData`ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã‚Œã¯ã€[Hermes](https://github.com/pyth-network/pyth-crosschain/tree/main/hermes?ref=berachain.ghost.io)ã‚’ä½¿ç”¨ã—ã¦å–å¾—ã—ã¾ã™ã€‚Hermes ã¯ã€Pyth Network ã‹ã‚‰ä¾¡æ ¼ã®æ›´æ–°ã‚’å—ä¿¡ã—ã€REST API ã‚’ä»‹ã—ã¦æä¾›ã™ã‚‹ã‚¦ã‚§ãƒ–ã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã€‚

`ETH/USD`ã® priceId ã‚’ä½¿ç”¨ã—ã¦ã€`priceUpdateData`ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è¡Œã„ã¾ã™:

```terminal
# FROM: ./pyth-oracle

curl -s "https://hermes.pyth.network/v2/updates/price/latest?&ids[]=0xff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace" | jq -r ".binary.data[0]" > price_update.txt
```

`jq`ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’ä½¿ç”¨ã—ã¦ã€å‡ºåŠ›ã‚’`price_update.txt`ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¾Œã§ç°¡å˜ã«å–å¾—ã§ãã¾ã™ã€‚

ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ãŸã‚‰ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦`updatePrice`ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚Pyth ã‹ã‚‰å—ã‘å–ã£ãŸãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ç½®ãæ›ãˆã¾ã™ã€‚

```terminal
# FROM: ./pyth-oracle

cast send <YOUR_DEPLOYED_CONTRACT> --rpc-url $BERACHAIN_ARTIO_RPC "updatePrice(bytes[])"  "[0x`cat price_update.txt`]" --account deployer --value 0.0001ether

# [Expected Similar Output]:
# blockHash               0xf00e38ea8197d088973dc51502b9fb62d089ac31b6fe01002e83a969e9c05f93
# blockNumber             1037572
# contractAddress
# cumulativeGasUsed       208351
# effectiveGasPrice       3000000017
# from                    0x529CA3A690E1bB4e9F04d132bd99D4398f626A44
# ...
```

æ¬¡ã«ã€`getPrice()`ã§ä¾¡æ ¼ã‚’ã‚¯ã‚¨ãƒªã—ã¾ã™ï¼š

```
cast call <YOUR_DEPLOYED_CONTRACT> --rpc-url $BERACHAIN_ARTIO_RPC "getPrice()"

# [Expected Similar Output]
# 0x0000000000000000000000000000000000000000000000000000005eb4cf6d2800000000000000000000000000000000000000000000000000000000130c6cd8fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000000065ef9853
```

ã“ã‚Œã¯ã€Solidity ã® `Price` æ§‹é€ ä½“ (`./pyth-oracle/lib/pyth-sdk-solidity/PythStructs.sol` ã‹ã‚‰) ã® `ETH/USD` ä¾¡æ ¼ã‚’æä¾›ã—ã¾ã™ï¼š

```solidity
struct Price {
        // Price
        int64 price;
        // Confidence interval around the price
        uint64 conf;
        // Price exponent
        int32 expo;
        // Unix timestamp describing when the price was published
        uint publishTime;
    }
```

16 é€²æ•°å‡ºåŠ›ã‚’äººé–“ãŒèª­ã‚ã‚‹å½¢å¼ã«ãƒ‡ã‚³ãƒ¼ãƒ‰ã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®`abi-decode`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã“ã¨ãŒã§ãã¾ã™:

```terminal
# FROM: ./pyth-oracle

cast abi-decode "getPrice()(int64,uint64,int32,uint)"  <YOUR_GETPRICE_OUTPUT>

# [Example Decoded Output of ETH/USD Feed]
# 406760418600 [4.067e11]
# 319581400 [3.195e8]
# -8
# 1710200915 [1.71e9]
```

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

- ç´ æ—©ãè¡Œå‹•ã—ãªã„ã¨ã€`0x19abf40e`ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã«é­é‡ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯`StalePrice`ï¼ˆå¤ã„ä¾¡æ ¼ï¼‰ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ã—ã¦ãŠã‚Šã€`price_update.txt`ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ãŒå¤ã™ãã¦ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§ä½¿ç”¨ã§ããªã‹ã£ãŸã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚ã“ã®ã‚ˆã†ãªå ´åˆã¯ã€ã“ã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚³ãƒãƒ³ãƒ‰æ‰‹é †ã‚’å†åº¦å®Ÿè¡Œã—ã¦ãƒªãƒˆãƒ©ã‚¤ã—ã¦ãã ã•ã„ã€‚

- ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰`0x025dbdd4`ã¯`InsufficientFee`ï¼ˆæ‰‹æ•°æ–™ä¸è¶³ï¼‰ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®å ´åˆã€`updatePrice`å‘¼ã³å‡ºã—æ™‚ã®$BERA å€¤ã‚’å¢—ã‚„ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ä¾‹ãˆã°ã€`0.0005ether`ã«ä¸Šã’ã¦ã¿ã‚‹ã®ãŒã‚ˆã„ã§ã—ã‚‡ã†ã€‚

## ã¾ã¨ã‚

ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚ãªãŸã¯ã€Berachain Testnet ä¸Šã® Pyth ã‚ªãƒ©ã‚¯ãƒ«ã‹ã‚‰ä¾¡æ ¼ãƒ‡ãƒ¼ã‚¿ã‚’å¼•ãå‡ºã™ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«æˆåŠŸã—ã¾ã—ãŸ ğŸ‰ã€‚

---

### ğŸ» Full Code Repository

æœ€çµ‚çš„ãªã‚³ãƒ¼ãƒ‰ã‚„ä»–ã®ã‚¬ã‚¤ãƒ‰ã‚’è¦‹ãŸã„å ´åˆã¯ã€[**_Berachain Pyth Guide Code_**](https://github.com/berachain/guides/tree/main/apps/pyth-oracle?ref=berachain.ghost.io)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

https://github.com/berachain/guides/tree/main/apps/pyth-oracle?ref=berachain.ghost.io

### ğŸ› ï¸ ã•ã‚‰ã«é–‹ç™ºã‚’é€²ã‚ãŸã„ã§ã™ã‹ï¼Ÿ

Berachain ã§ã•ã‚‰ã«é–‹ç™ºã‚’é€²ã‚ãŸã„ã€ã‚ˆã‚Šå¤šãã®å®Ÿè£…ä¾‹ã‚’è¦‹ãŸã„ã¨ãŠè€ƒãˆã§ã™ã‹ï¼Ÿç§ãŸã¡ã®[**_Berachain GitHub ã‚¬ã‚¤ãƒ‰ãƒªãƒã‚¸ãƒˆãƒª_**](https://github.com/berachain/guides?ref=berachain.ghost.io)ã‚’ãœã²ã”è¦§ãã ã•ã„ã€‚ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ã¯ã€NextJSã€Hardhatã€Viemã€Foundry ãªã©ã€æ§˜ã€…ãªæŠ€è¡“ã‚’ä½¿ç”¨ã—ãŸå¹…åºƒã„å®Ÿè£…ä¾‹ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

https://github.com/berachain/guides/tree/main?ref=berachain.ghost.io

ã‚ˆã‚Šè©³ç´°ãªæƒ…å ±ã‚’æ¢æ±‚ã—ãŸã„å ´åˆã¯ã€[**_Berachain ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ_**](https://docs.berachain.com/?ref=berachain.ghost.io)ã‚’ã”è¦§ãã ã•ã„ã€‚

https://docs.berachain.com/?ref=berachain.ghost.io

### é–‹ç™ºè€…ã‚µãƒãƒ¼ãƒˆã‚’ãŠæ¢ã—ã§ã™ã‹ï¼Ÿ

è³ªå•ã‚’ã™ã‚‹ãŸã‚ã«ã€[**_Berachain Discord_**](https://discord.com/invite/berachain?ref=berachain.ghost.io)ã‚µãƒ¼ãƒãƒ¼ã«å‚åŠ ã—ã€é–‹ç™ºè€…ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚

â¤ï¸ ã“ã®è¨˜äº‹ã«å¯¾ã—ã¦æ„›ã‚’ç¤ºã™ã®ã‚’å¿˜ã‚Œãªã„ã§ãã ã•ã„ ğŸ‘ğŸ¼

---

:::note info
ã€Sunrise ã¨ã¯ã€‘
Sunrise ã¯ Proof of Liquidity(PoL)ã¨ Fee Abstractionï¼ˆæ‰‹æ•°æ–™æŠ½è±¡åŒ–ï¼‰ã‚’å‚™ãˆãŸãƒ‡ãƒ¼ã‚¿å¯ç”¨æ€§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã§ã™ã€‚ ç§ãŸã¡ã¯ DA ã®ä½“é¨“ã‚’å†æ§‹ç¯‰ã—ã€å¤šæ§˜ãªã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ©ãƒ¼å‹æµå‹•æ€§ã‚’æ´»ç”¨ã—ã¦ãƒ­ãƒ¼ãƒ«ã‚¢ãƒƒãƒ—ã‚’ç«‹ã¡ä¸Šã’ã¦ã„ã¾ã™ã€‚

- [Sunrise - Specialized DA Layer for Proof of Liquidity](https://sunriselayer.io/)
- [Sunrise / Gluon Docs](https://docs.sunriselayer.io/)

ã€Social Linksã€‘

- [X(æ—§ Twitter)[è‹±èª])](https://twitter.com/SunriseLayer)
- [X(æ—§ Twitter)[æ—¥æœ¬èª])](https://twitter.com/SunriseLayer)
- [Discord Community](https://discord.com/invite/sunrise)
- [Medium](https://sunriselayer.medium.com/)
- [Github](https://github.com/sunriselayer)
- [Linkedin](https://www.linkedin.com/company/sunriselayer)

ã€ãŠå•åˆã›ã€‘
Sunrise ã¸ã®ãŠå•ã„åˆã‚ã›ã¯ã“ã¡ã‚‰ã‹ã‚‰ ğŸ‘‰ [Google Form](https://forms.gle/h8RVahxRtXUvYwnv6)

![1080x360.jpeg](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3839047/8971d83b-3331-4757-dc72-320d28618735.jpeg)

:::
