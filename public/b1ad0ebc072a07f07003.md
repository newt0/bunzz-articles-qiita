---
title: ERC3156 Flash Loans (Flash Borrower) ã€Bunzzã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€‘
tags:
  - ä»®æƒ³é€šè²¨
  - ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³
  - DApps
  - Web3
  - DeFi
private: false
updated_at: '2024-05-15T14:38:08+09:00'
id: b1ad0ebc072a07f07003
organization_url_name: bunzzdev
slide: false
ignorePublish: false
---
:::note info
æœ¬è¨˜äº‹ã¯ä¸‹è¨˜ã®ç¿»è¨³ã¨ãªã‚Šã¾ã™ã€‚
[ã€ERC3156 Flash Loans (Flash Borrower) Smart Contract Module in Bunzz ã€]()
:::

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/1926720/01302747-268d-2a7e-7265-32de3cf5967c.png)

FlashBorrower ã¯ ERC-3156ï¼šFlash Loans ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã‚ã‚Šã€{ERC20}ã®æ‹¡å¼µæ©Ÿèƒ½ã§ã‚ã‚Šã€ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã¯ã€è²¸ã—æ‰‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãŒè²¸ã—æ‰‹ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«è³‡ç”£ã‚’è²¸ã—å‡ºã™æ¡ä»¶ä»˜ãã§ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®çµ‚äº†å‰ã«è³‡ç”£ãŒè¿”å´ã•ã‚Œã‚‹ã“ã¨ã‚’æŒ‡ã™ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚

ERC-3156ï¼šFlash Loans ã¯ã€è²¸ã—æ‰‹ãŒãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å…¥ã‚Œã‚‹ãŸã‚ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¨ã€è²¸ã—æ‰‹ã®å®Ÿè¡Œå†…ã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸€æ™‚çš„ãªåˆ¶å¾¡ã‚’å–ã‚‹ãŸã‚ã®å€Ÿã‚Šæ‰‹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚

ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã®å®‰å…¨ãªå®Ÿè¡Œã®ãƒ—ãƒ­ã‚»ã‚¹ã‚‚æŒ‡å®šã•ã‚Œã¦ã„ã¾ã™ã€‚

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã‚³ãƒ¼ãƒ‰ã«ã¯ã€[https://bit.ly/3GfPhMN](https://bit.ly/3GfPhMN)ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

### ä½¿ã„æ–¹

è²¸ã—æ‰‹ã¯{IERC3156FlashLender}ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã®å—ä¿¡è€…ã¯{IERC3156FlashBorrower}ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã®å€Ÿã‚Šæ‰‹ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å®Ÿè£… => FlashBorrower.sol (ERC-3156ï¼šFlash Loans ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)
- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒŸãƒ³ãƒˆã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å®Ÿè£… => FlashMinter.sol (ERC-3156ï¼šFlash Loans ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)
- ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹å®Ÿè£… => FlashRender.sol (ERC-3156ï¼šFlash Loans ã‚µãƒ–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«)

æ¬¡ã®ã‚ˆã†ã«{flashLoan}é–¢æ•°ã‚’å®Ÿè£…ã§ãã¾ã™ï¼š

```
/// @dev ERC-3156ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°function onFlashLoan(    address initiator,    address token,    uint256 amount,    uint256 fee,bytes calldata data) external override returns(bytes32) {    require(        msg.sender == address(lender),        "FlashBorrower: Untrusted lender"    );    require(        initiator == address(this),        "FlashBorrower: Untrusted loan initiator"    );    (Action action) = abi.decode(data, (Action));    if (action == Action.NORMAL) {        // ä½•ã‹ã‚’å®Ÿè¡Œã™ã‚‹    } else if (action == Action.OTHER) {        // åˆ¥ã®ã“ã¨ã‚’å®Ÿè¡Œã™ã‚‹    }    return keccak256("ERC3156FlashBorrower.onFlashLoan");}/// @dev ãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ­ãƒ¼ãƒ³ã‚’é–‹å§‹ã™ã‚‹é–¢æ•°function flashBorrow(    address token,    uint256 amount) public {    bytes memory data = abi.encode(Action.NORMAL);    uint256 _allowance = IERC20(token).allowance(address(this), address(lender));    uint256 _fee = lender.flashFee(token, amount);    uint256 _repayment = amount + _fee;    IERC20(token).approve(address(lender), _allowance + _repayment);    lender.flashLoan(this, token, amount, data);}
```

### é–¢æ•°

**#WRITE**

- flashBorrow
- flashBorrowAndReenter
- onFlashLoan
- transferOwnership
- approveRepayment
- flashBorrowAndSteal
- renounceOwnership

#READ

- flashAmount
- flashBalance
- flashFee
- flashInitiator
- flashToken
- owner

ã“ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã‚³ãƒ¼ãƒ‰ã«ã¯ã€[https://bit.ly/3GfPhMN](https://bit.ly/3GfPhMN)ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

---

---

:::note info
ã€Bunzz ã¨ã¯ã€‘
Bunzz ã¯ã‚¢ã‚¸ã‚¢æœ€å¤§ç´šã® DApps é–‹ç™ºã‚¤ãƒ³ãƒ•ãƒ©ã‚’é‹å–¶ã™ã‚‹ã€web3Ã—LLM ã«ãŠã‘ã‚‹ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚«ãƒ³ãƒ‘ãƒ‹ãƒ¼ã§ã™ã€‚ã€Œå…¬å…±è²¡ã¨ã—ã¦ã®ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã€ã®å®Ÿç¾ã«å‘ã‘ã¦ã€å„ç¨® web3 ã‚¤ãƒ³ãƒ•ãƒ©ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã‚’é–‹ç™ºãƒ»æä¾›ã—ã¦ãŠã‚Šã¾ã™ã€‚

ã€Our Projectsã€‘

- **[Smart Contract Hub | ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã® Github](https://www.bunzz.dev/)**
- **[DeCipher | "Read me" for All of Contracts](https://www.bunzz.dev/decipher)**
- **[Bunzz for Enterprise | Tier1 ã®æŠ€è¡“ãƒªã‚½ãƒ¼ã‚¹ã‚’æ—¥æœ¬ä¼æ¥­ã«æä¾›](https://enterprise.bunzz.dev/ja)**
- **[Bunzz Audit | é€æ˜ã‹ã¤æŒç¶šçš„ãªã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆç›£æŸ»ã®ä»•çµ„ã¿ã‚’å®Ÿç¾](hhttps://www.bunzz.dev/audit)**

ã€Social Linksã€‘

- [X(æ—§ Twitter))](https://twitter.com/BunzzDev)
- [Discord Community](https://t.co/6hHgssJdvW)
- [Youtube](https://www.youtube.com/@bunzzdev)
- [Instagram](https://www.instagram.com/bunzzdev/)

ã€ãŠå•åˆã›ã€‘
web3 é–‹ç™ºãƒ»ã‚³ãƒ³ã‚µãƒ«ãƒ†ã‚£ãƒ³ã‚°ã®ã”ç›¸è«‡ã¯ã“ã¡ã‚‰ã‹ã‚‰ ğŸ‘‰[Google Form](https://forms.gle/4tgQjWSw2MMMZW6E6)
:::

:::note info
Bunzz R&D ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢è’ç‰§ã•ã‚“ã®è‘—æ›¸[ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä»•çµ„ã¿ã¨æ³•å¾‹ã€](https://amzn.to/3V03sNH)ãŒå¥½è©•ç™ºå£²ä¸­ã§ã™ ğŸ“•
<a href="https://amzn.to/3V03sNH" rel="nofollow" referrerpolicy="no-referrer-when-downgrade">
<img
    src="https://m.media-amazon.com/images/I/81wopoZ1K4L._SY522_.jpg"
    alt="ã€ã‚¹ãƒãƒ¼ãƒˆã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ä»•çµ„ã¿ã¨æ³•å¾‹ã€ï¼ˆä¸­å¤®çµŒæ¸ˆã‚°ãƒ«ãƒ¼ãƒ—ãƒ‘ãƒ–ãƒªãƒƒã‚·ãƒ³ã‚°ï¼‰"
    width="200px"
    height="auto"
    Style="border: 0px;"
  />
</a>
:::
